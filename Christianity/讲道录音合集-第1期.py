# -*- coding:utf-8 -*-


import requests
import re
from selenium import webdriver
from selenium.webdriver.common.by import By
import time

text = '<p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247484700&amp;idx=1&amp;sn=194083ce1c457b667fdb759efb52e636&amp;chksm=faf352b9cd84dbaf7f49a80fd5f958d74719724991daa1d9d27796a14e12fe333932750e3741&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">你的信救了你</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247484786&amp;idx=1&amp;sn=3694b631311df2bdd58d85a6d24cad60&amp;chksm=faf352d7cd84dbc18f8b8ae6fa3bb1e975be2e3345270c5786c08dd17e17660848ca9c1ac1e6&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">圣经始末</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247484840&amp;idx=1&amp;sn=97df243ea2b2af0fcfc9d9ec1e8807f8&amp;chksm=faf3520dcd84db1b7dfb46e93a19e1bd2d11900a52efd809065379f0c6d078998f87fd24aab1&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">谁是我的邻舍</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247484867&amp;idx=1&amp;sn=8ca887c41f34b8f029f4d011cf975667&amp;chksm=faf35266cd84db7028a7f52767881cd0a6c046a5b3107625852554c0972382f120c18f48759d&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">路得记</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247484889&amp;idx=1&amp;sn=83c98350836da8a688dbf3742725e9b1&amp;chksm=faf3527ccd84db6a1c5fdebfde6d71c9f71e18ee813beb353f41fa720f66f377a516f63cfc50&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">你还缺少一件</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247484921&amp;idx=1&amp;sn=59bbcec3d4f65491a04f2cc46f5a6af2&amp;chksm=faf3525ccd84db4a7d844ab6baff7960750f893cc35c09a33b840bf0a68cce5c8210bc29cd8d&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">新郎来了</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247484898&amp;idx=1&amp;sn=e6c5595616bcab2c47489ee845637a68&amp;chksm=faf35247cd84db51351d28a0a1c20d6a06fe2fd84575a0eb3f11509f820d615ea0eb1e41c267&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">我也不定你的罪</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485091&amp;idx=1&amp;sn=3c28fac2a31445e31c43605ab97f233e&amp;chksm=faf35106cd84d810f86f26e0b926251bfacabd3c5a1f005c78a9e9ccf3076116e40745f09c54&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">数算主的恩典</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485097&amp;idx=1&amp;sn=e048140ec4815f257bec121f7ff9e5e7&amp;chksm=faf3510ccd84d81a81f21efb82594902ace472c5f32d7ab8e353f4f04cf70dfa83a257f2e610&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">基督复临的征兆</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485115&amp;idx=1&amp;sn=6ab2487a1e27f4b7edb66b338573d872&amp;chksm=faf3511ecd84d80835288d7b904413319d0e28dc7edb1f7a8d0ccd6a5e18f86f178e36887d59&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">唯一的安全之所</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485156&amp;idx=1&amp;sn=5f6b2cc7fa4f6c1b32ea75b6660a7554&amp;chksm=faf35141cd84d85711a749b740f9c5de782e407cb3761bf44a3cfc359926beb1c20891de00ad&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">愿你们平安</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485164&amp;idx=1&amp;sn=7c6fe47e6b3ecea515c76658be636f20&amp;chksm=faf35149cd84d85fed494b0e04ea910263157c5d3b23f012775cb70068ee8018635c2be7b307&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">生命的奇妙</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485170&amp;idx=1&amp;sn=6ecb72822ae7e9a432158164cae45a73&amp;chksm=faf35157cd84d841fd497abd9bea10a541611beabe3a283351288cbe9b051fe976f288e4ae54&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">你洁净了吧</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485318&amp;idx=1&amp;sn=61a1172329ccd20d51b88e76a6ea305d&amp;chksm=faf35023cd84d935ee8c5908b5df8d8ea13bd70a36b14d45017866fa1e9aff176c69d8cbc7fb&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">他驾云降临</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485543&amp;idx=1&amp;sn=ad159f4963e6849a903e35bef32c4a05&amp;chksm=faf35fc2cd84d6d47108309b5f769e18db3a237f350413c7d613f73ed68229ec355a1f0c614b&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">到耶稣面前来</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485712&amp;idx=1&amp;sn=9b4ec97ffb25c835e5caf3eeebd5860b&amp;chksm=faf35eb5cd84d7a375fefaf0d84c8768243141f820837cf30abd56b432ffc9b78ad69f12b69d&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">天国来信</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247485758&amp;idx=1&amp;sn=b984827f9e9d396363b45f968c22f1cc&amp;chksm=faf35e9bcd84d78d775f9276f08045a5f724cf0cacc2a4f8673ddc895356fa00d9db137e65a2&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">你们给他们吃吧</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486036&amp;idx=1&amp;sn=97ff081604a8f9a46f147dea14572591&amp;chksm=faf35df1cd84d4e73ea06ad7a953a45ea5a9f165be5d603138c8d3861b555219765093eb5dc9&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">我若死就死吧</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247487140&amp;idx=2&amp;sn=36f35e7f2efb4e51693478ac5b531063&amp;chksm=faf35901cd84d0175dbf13f9b949453d8e42204e98e57acd09bc3840bd9fb62d72ee221393e9&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">路得记中的王权</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486132&amp;idx=1&amp;sn=6595f56694fbc1c2fafa56757c4edb41&amp;chksm=faf35d11cd84d4076fc736bf0d8e185e650e3c0a52488198c602357bd01d92bcbd3480538e6b&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">半夜呼声</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486157&amp;idx=1&amp;sn=8700b5ba4ee2b0df77796e0a53ecf6e7&amp;chksm=faf35d68cd84d47ebe0c16f319d620c519b09eeca56d134b45be8e3088d87e305796986d52ee&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">他们都跟从他</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486191&amp;idx=1&amp;sn=bdee254ff1473f67db7eab509317fe1b&amp;chksm=faf35d4acd84d45ced41a829e55c32d68de754003afed5fde12bb608a1f5785e1aae53bd3095&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">圣灵的大能</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486218&amp;idx=1&amp;sn=c1278eda2a5707dc648472e4379c62ff&amp;chksm=faf35cafcd84d5b9069b0b17a586b720e93be496cac26664cf5e15011cae259db962586f0dcd&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">走向审判台</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486225&amp;idx=1&amp;sn=49b5f3b16f1f6197e92781aab60a06a5&amp;chksm=faf35cb4cd84d5a236d00569cdebab50dfb70d4974bdb2169a84c4d0854b6ce8d9db93f2a1fb&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">与上帝同行</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486251&amp;idx=1&amp;sn=1ca3277983c9ab90c3d05d33f30bf975&amp;chksm=faf35c8ecd84d59865b51ed00a37202c5249fd14fb7e9285c9753f11bd70ed3a32ac42ca605a&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">耶稣的吸引力</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486265&amp;idx=1&amp;sn=05e0c1cd9bd8a4f8aa93b9ffd054b0d1&amp;chksm=faf35c9ccd84d58ac3759d1c226f898c9d8f09d2a517fed4e840ee3afa61e6e2daae257d66a5&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">福音和律法</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486309&amp;idx=1&amp;sn=44ab46e22e2e19c4d2931e4706a31a53&amp;chksm=faf35cc0cd84d5d6c3f23403c02d7c4b1c04075167d2ea804531ddabea4622f0cbe90bf9d77d&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">对信心的思考</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486639&amp;idx=8&amp;sn=45bc08044a787701deff27d502fef1c1&amp;chksm=faf35b0acd84d21ce0609b2f5b5c97247e9c65c38d59c29e594b2bf80124c74955d19e89bcb7&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">加利利的第二件神迹</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486907&amp;idx=8&amp;sn=25f0ca3205d301179d6ed4da3598f00d&amp;chksm=faf35a1ecd84d308c5316f5b676444ee109fd188ec952e435623fe0e148844ca29e3a0358993&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">默然的爱</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486964&amp;idx=1&amp;sn=9d788b8cadfa4f56ad19c4ec71809760&amp;chksm=faf35a51cd84d347df4c9a88584f1d27e796ffb464e462411ca22a28713d9d2f92812eb12f81&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">撒种的比喻</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247486991&amp;idx=1&amp;sn=04f67bb57ab33c4ef4f94a4083b24b4a&amp;chksm=faf359aacd84d0bc71ee2f13ef1ad108e71486634932baaebee85291687b91465c93b816fdec&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">救赎的计划</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzUzNjcwNzc4Ng==&amp;mid=2247487079&amp;idx=1&amp;sn=3863ecc5b73f3296ec6370fc3cf15dad&amp;chksm=faf359c2cd84d0d40b936119012f3a82f3b15a8bd9dfd5c99052425c58ffb598e64271f489d2&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" tab="innerlink" data-linktype="2">基督的牺牲</a></p>'

browser = webdriver.Edge('msedgedriver.exe')

def download_audio(page_link, title):
    for i in range(1, 33):
        browser.get(page_link[i])
        time.sleep(1)
        btn = browser.find_elements(By.XPATH, '//*[@id="audio_play_btn"]')
        for a in btn:
            a.click()
        time.sleep(2)
        html = browser.page_source
        ex = 'autoplay="" src="(.*?)"'
        audio_link = re.findall(ex, html, re.S)

        index = 0
        for link in audio_link:
            data = requests.get(link, timeout=20).content
            path = 'D:/zz/讲道录音合集-第1期/' + str(i) + title[i] + str(index) + '.mp3'
            with open(path, 'wb') as fp:
                fp.write(data)
                print(id, '下载成功')
                index += 1

if __name__ == '__main__':
    page_link = []
    ex = '<p><a href="(.*?)"'
    page_link += re.findall(ex, text, re.S)

    title = []
    ex1 = 'data-linktype="2">(.*?)</a></p>'
    title += re.findall(ex1, text, re.S)

    download_audio(page_link, title)